<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "Page on w3.org">
<html xmlns="XHTML namespace">
  <head>
    <title>JSON to CSV</title>
    <!-- <script src="scripts/json.js" type="text/javascript"></script> -->
    <script type="text/javascript">
      function myfunction() {
        var json3 = document.forms["myform"]["formarea"].value;
        console.log(json3);
        var root = document.forms["myform"]["root"].value;
        DownloadJSON2CSV(JSON.parse(json3)["data"]);
        //console.log(json3.data);
        //(json3.data);
      }

      function DownloadJSON2CSV(objArray) {
        var array =
          typeof objArray != "object" ? JSON.parse(objArray) : objArray;

        var str = "";

        for (var i = 0; i < array.length; i++) {
          var line = "";

          for (var index in array[i]) {
            line += array[i][index] + ",";
          }

          // Here is an example where you would wrap the values in double quotes
          // for (var index in array[i]) {
          //    line += '"' + array[i][index] + '",';
          // }

          line.slice(0, line.Length - 1);

          str += line + "\r\n";
        }
        window.open("data:text/csv;charset=utf-8," + escape(str));
      }
    </script>
  </head>
  <body>
    <form name="myform">
      <textarea
        id="json_input"
        name="formarea"
        rows="30"
        cols="1000"
        spellcheck="false"
        placeholder="Enter JSON to convert"
        wrap="off"
        style="resize: both; width: 889px; max-width: 883px;"
      ></textarea>
      <br />
      Enter Above JSON's Root: <input type="text" name="root" /><br />
    </form>

    <button type="button" onclick="myfunction()">Submit</button>
  </body>
</html>
